<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1" />  

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>排查PHP代码连接Mysql数据库错误的6大方法-TU30.com</title>



<style type="text/css">

body {
	background-color: #707070;
	color: #000;
	line-height: 160%;
}


.container {
	width: 80%;
	max-width: 1000px;
	min-width: 1000px;
	background-color: #FFF;
	margin: 0 auto; 

}





.content {
	padding: 10px 0;
	margin: 10px;
	padding: 10px;
	background-color: #FAFAFA;
	
	word-wrap:break-word;
}








a:link {
	text-decoration: none;
}
a:visited {
	text-decoration: none;
}
a:hover {
	text-decoration: none;
}
a:active {
	text-decoration: none;
}
</style>







<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?2f2f6867d47ab5450b8612721837a7bc";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</head>

<body>

<div class="container">
  
  <div class="content">
 <h1 align="left"><strong><a href="../index.html">TU30.com</a></strong></h1>
 
 
 <script type="text/javascript">
    /*头部*/
    var cpro_id = "u1993279";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
 
 
  <h3>[分类导航]：<strong> <a href="../1index1.html">PHP</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="../2index1.html">趣闻</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="../3index1.html">我的地盘</a></strong></h3>
   <h4><strong>所在位置：<a href="../index.html">TU30.com</a></strong>&gt;<a href="../index.html"> <a href="../1index1.html">PHP</a></a>&gt; 排查PHP代码连接Mysql数据库错误的6大方法</h4>

<h1>排查PHP代码连接Mysql数据库错误的6大方法</h1>
<p><em>2015-03-21 21:34:58 </em></p>





<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<br>
<div>如果是一个PHP新手，在编写与数据库连接的代码的时候可能会出现很多错误（bug)，那么，我们该如何排查、找出这些错误（bug）呢？下边，图三十网（tu30.com）的博主将通过一个例子来和新手们探讨这个问题。</div><div>&nbsp; &nbsp; 有一位同学和我说，他试图从一个MySQL表中选择数据,但是他得到以下错误消息：</div><div>&nbsp; &nbsp; mysql_fetch_array() expects parameter 1 to be resource, boolean given</div><div>或者</div><div>&nbsp; &nbsp; mysqli_fetch_array() expects parameter 1 to be mysqli_result, boolean given</div><div>&nbsp;</div><div>&nbsp; &nbsp; 下边是他的代码：</div><div>&nbsp; &nbsp; $username = $_POST['username'];&nbsp;</div><div>&nbsp; &nbsp; $password = $_POST['password'];&nbsp;</div><div>&nbsp; &nbsp; $result =mysql_query('SELECT * FROM Users WHERE &nbsp; &nbsp; &nbsp; &nbsp;UserName LIKE $username');&nbsp;</div><div>&nbsp; &nbsp; while($row = mysql_fetch_array($result)) { &nbsp;&nbsp;</div><div>&nbsp; &nbsp; Echo $row['FirstName'];&nbsp;</div><div>&nbsp; &nbsp; &nbsp; }</div><div>对于这个例子，图三十网（tu30.com）博主的意见是，因为查询语句有问题，所以导致了$result的结果是错误的，因而把$result放到mysql_fetch_arry函数里边就会出现错误提示。在以下函数中使用了错误的查询语句，便会出现类似的错误提示：</div><div>·mysql_fetch_array/mysqli_fetch_array()</div><div>·mysql_fetch_assoc()/mysqli_fetch_assoc()</div><div>·mysql_num_rows()/mysqli_num_rows()</div><div>&nbsp;那么，我们先暂且撇下具体错误不谈，我们该如何查找出查询语句的错误呢？下边我们来谈谈具体的排查PHP代码连接Mysql数据库错误的6大方法：</div><div>&nbsp; &nbsp; 1、确保你的服务器正确设置了提示所有错误。如果没有的话，你可以把下边的语句放在你的设置文件的首行：</div><div>&nbsp; &nbsp; error_reporting(-1);</div><div>&nbsp; &nbsp; 这么一来，如果出现了语法错误，那么系统将会把他们全部提示出来。</div><div>&nbsp; &nbsp; 2、使用mysql_error()，前边这个函数将会提示所有你会遇到的Mysql查询错误。下边给出一小段代码作为例子，你也可以照着这个例子写代码以便于排查错误：</div><div>mysql_connect($host, $username,$password) or die("cannot connect");&nbsp;</div><div>mysql_select_db($db_name) ordie("cannot select DB");&nbsp;</div><div>$sql = "SELECT * FROM table_name"; $result = mysql_query($sql);&nbsp;</div><div>if (false ===$result) { &nbsp; &nbsp;&nbsp;</div><div>echo mysql_error();</div><div>&nbsp;}</div><div>&nbsp; &nbsp; 3、在phpadmin的命令行里边运行你的Mysql查询语句，如果你有语法错误，那么PHPadmin会提示你错误在哪里。</div><div>&nbsp; &nbsp; 4、确保你的引号是正确的。引号的缺失常常会引起查询错误。</div><div>&nbsp; &nbsp; 5、确保你的字符转义正确。不正确的使用引号，会导致查询错误，并且可能会产生sql注入漏洞。这个时候，你可以使用mysql_real_escape_string() 函数转义 SQL 语句中的特殊字符。</div><div>&nbsp; &nbsp; 6、确保你没有混用mysqli和mysql函数。它们是不同的函数，不要混用它们。</div><div>再一次强调，不推荐使用mysql函数，它们即将被php7删掉。你应该使用PDO或者mysqli来代替mysql函数。</div><div>回到文章开头那位同学提出的问题，因为他没有给出数据库结构，我们不可能直接帮他找出错误。但是相信各位看完这篇图三十网（tu30.com）博主的文章，是可以自己找出代码中的错误的。</div>

<script type="text/javascript">
    /*中部*/
    var cpro_id = "u1993309";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="1aid40" data-title="请替换成文章的标题" data-url="请替换成文章的网址"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"tu30"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->





<!--下一行是百度推荐代码-->
<div id="hm_t_53900"></div>






<p><em>上一篇</em>：没有了</p>
<p><em>下一篇</em>：<a href="39.html">PHP里不应该再使用mysql函数的3大原因</a></p>
<p><em>最新十篇文章</em>：</p>
<a href="40.html">排查PHP代码连接Mysql数据库错误的6大方法</a><br><a href="39.html">PHP里不应该再使用mysql函数的3大原因</a><br>
<hr />
<script type="text/javascript">
    /*底部*/
    var cpro_id = "u1993422";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>


<script type="text/javascript">
    /*对联*/
var cpro_id = "u1993473";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>

<script type="text/javascript">
    /*内文2*/
var cpro_id = "u1993448";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/cnw.js" type="text/javascript"></script>

<!--<script type="text/javascript">
    /*右下角 大*/
var cpro_id = "u1993496";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>
-->
<script type="text/javascript">
    /*图片*/
var cpro_id = "u1993432";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/i.js" type="text/javascript"></script>


<script type="text/javascript">
    /*按钮*/
var cpro_id = "u1994565";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>


<script type="text/javascript">
    /*右下角 大*/
var cpro_id = "u1993496";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>

 <script type="text/javascript">
    /*左右折叠*/
    var cpro_id = "u1994578";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/s.js" type="text/javascript"></script>

<div align="center">
  <p><a href="../index.html">TU30.com</a>保持所有权利。本静态博客由<a href="../index.html">TU30-Blog</a>强力驱动！本站文章除非特殊说明，均为原创，如果转载，必须注明出处和原始链接，盗版必究！</p>
  <p>（需要源码的请加qq群308730553)
  
  </p>


</div>
<p>&nbsp;</p>
  
  
  <!-- end .content --></div>
 
<!-- end .container --></div>


</body>
</html>